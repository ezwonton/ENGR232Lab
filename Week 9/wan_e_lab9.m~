%% Eric Wan - ezw23@drexel.edu - Lab9
clear all
close all
clc


x0 = [0;0];
A = [0 1; -10 -2];
B = [0; 1];
%% Part 1
[v, d] = eig(A);
d


%% Part 2
syms s
Us = 1/s;
Xs = inv(s * eye(2) - A) * x0+ inv(s * eye(2) - A) * B * Us; 
X1s = simplify(Xs(1,1))
X2s = simplify(Xs(2,1))

%% Part 3
x1t = ilaplace(X1s)
x2t = ilaplace(X2s)

%% Part 4
IC = x0;
ep = inv(A)*-B;
x1 = matlabFunction(x1t)
x2= matlabFunction(x2t)
t = 0:0.01:15;

subplot(2,2,1);
plot(t,x1(t),'r', 'linewidth', 2);
grid on;
ylabel('x_1(t)');
xlabel('t')
title('x_1(t) vs t')

subplot(2,2,3)
plot(t,x2(t), 'linewidth', 2)
grid on;
ylabel('x_2(t)')
xlabel('t')
subplot(1,2,2)
plot(x1(t),x2(t),'g', 'linewidth', 2)
hold on

%% Plot 5
plot(IC(1),IC(2),'b*',ep(1),ep(2),'k*')
plot(ep(1),ep(2),'ko')
xlabel('x_1(t)'), ylabel('x_2(t)')
title('Phase Plot')
legend('Analytical Trajectory','Initial Condition','Eq Point','Location','best')
grid on